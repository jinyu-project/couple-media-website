# 配置 SSH 密钥免密登录

## 🎯 目的

配置后，同步数据时**不需要再输入密码**，更方便快捷。

## ⚡ 快速配置

### 方法一：使用脚本（推荐）

**直接双击运行：**
```
setup-ssh-key.bat
```

脚本会自动：
1. ✅ 检查本地是否有 SSH 密钥（没有则自动生成）
2. ✅ 将公钥复制到服务器
3. ✅ 测试免密登录是否成功

**只需要输入一次服务器密码即可完成配置！**

### 方法二：手动配置

如果脚本无法运行，可以手动配置：

#### 1. 检查本地是否有 SSH 密钥

```powershell
# 查看公钥
cat $env:USERPROFILE\.ssh\id_rsa.pub
```

如果没有，生成新密钥：
```powershell
ssh-keygen -t rsa -b 4096 -f "$env:USERPROFILE\.ssh\id_rsa"
```

#### 2. 复制公钥到服务器

```powershell
# 方法一：使用 ssh-copy-id（如果可用）
ssh-copy-id admin@39.97.243.8

# 方法二：手动复制
type $env:USERPROFILE\.ssh\id_rsa.pub | ssh admin@39.97.243.8 "mkdir -p ~/.ssh && cat >> ~/.ssh/authorized_keys"
```

#### 3. 测试免密登录

```powershell
ssh admin@39.97.243.8
```

如果不需要输入密码就能连接，说明配置成功！

## ✅ 配置成功后

- ✅ 运行 `sync-uploads-only.bat` 不需要密码
- ✅ 运行 `sync-from-server.bat` 不需要密码
- ✅ 使用 `scp` 命令不需要密码
- ✅ 使用 `ssh` 连接不需要密码

## 🔧 如果配置失败

1. **确认服务器密码正确**
2. **确认服务器 SSH 服务正常**：
   ```bash
   ssh admin@39.97.243.8
   sudo systemctl status sshd
   ```
3. **检查服务器权限**：
   ```bash
   ls -la ~/.ssh
   # 应该看到 authorized_keys 文件
   ```

## 📝 注意事项

- 配置只需要执行**一次**，之后永久有效
- 如果更换了服务器或重新安装了系统，需要重新配置
- SSH 密钥是安全的，比密码更安全

